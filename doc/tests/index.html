<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:9,&quot;tests&quot;:19,&quot;passes&quot;:19,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2018-12-05T15:30:59.274Z&quot;,&quot;end&quot;:&quot;2018-12-05T15:30:59.314Z&quot;,&quot;duration&quot;:40,&quot;testsRegistered&quot;:19,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false,&quot;passPercentClass&quot;:&quot;success&quot;,&quot;pendingPercentClass&quot;:&quot;danger&quot;},&quot;suites&quot;:{&quot;uuid&quot;:&quot;12624b55-1a4f-4c24-9dc8-8e56f4c67a5a&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;eeb46df2-9a4d-4291-9899-f4e581a0ca7e&quot;,&quot;title&quot;:&quot;Client&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/client/client.test.js&quot;,&quot;file&quot;:&quot;/src/client/client.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;integration test between client and server&quot;,&quot;fullTitle&quot;:&quot;Client integration test between client and server&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug   = require(&#x27;@superhero/debug&#x27;),\nlog     = new Debug({ debug:false }),\nFactory = require(&#x27;../../&#x27;),\nfactory = new Factory,\nclient  = factory.createClient(log),\nserver  = factory.createServer(log),\nport    = 18200,\nevent   = &#x27;foobar&#x27;,\nbody    = { foo:&#x27;bar&#x27; }\nserver.listen(port)\nclient.connect(port)\nclient.emit(event, body)\nserver.on(event, (context, data) =&gt;\n{\n  expect(data).to.deep.equal(body)\n  client.client.end()\n  server.server.close()\n  done()\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;87178988-3cf0-4850-862e-b16e47005fe3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;possible to remove a listener&quot;,&quot;fullTitle&quot;:&quot;Client possible to remove a listener&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug     = require(&#x27;@superhero/debug&#x27;),\nlog       = new Debug({ debug:false }),\nFactory   = require(&#x27;../../&#x27;),\nfactory   = new Factory,\nclient    = factory.createClient(log),\nevent     = &#x27;foobar&#x27;,\nlistener  = () =&gt; {}\nexpect(client.connectionObserver.dispatcher.events.listenerCount(event)).to.deep.equal(0)\nclient.on(event, listener)\nexpect(client.connectionObserver.dispatcher.events.listenerCount(event)).to.deep.equal(1)\nclient.removeListener(event, listener)\nexpect(client.connectionObserver.dispatcher.events.listenerCount(event)).to.deep.equal(0)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fb3327ff-3bd7-44c9-9de0-98be5e39313a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;87178988-3cf0-4850-862e-b16e47005fe3&quot;,&quot;fb3327ff-3bd7-44c9-9de0-98be5e39313a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:14,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;aa7a82e2-f865-4f14-8e33-6a12711403bb&quot;,&quot;title&quot;:&quot;ConnectionObserver&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/connection-observer/connection-observer.test.js&quot;,&quot;file&quot;:&quot;/src/connection-observer/connection-observer.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;attach data event to dispatcher with a context&quot;,&quot;fullTitle&quot;:&quot;ConnectionObserver attach data event to dispatcher with a context&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug               = require(&#x27;@superhero/debug&#x27;),\nlog                 = new Debug({ debug:false }),\nFactory             = require(&#x27;../../&#x27;),\nfactory             = new Factory,\nconnectionObserver  = factory.createConnectionObserverFactory(log).create(),\nnetSocket           = factory.createNetSocket(),\ndispatcher          = connectionObserver.dispatcher,\nemitter             = connectionObserver.emitter,\ncontext             = factory.createContextFactory().create(netSocket, emitter)\nexpect(netSocket.listenerCount(&#x27;data&#x27;)).to.be.equal(0)\nconnectionObserver.attachDataEventToDispatcherWithAContext(netSocket, dispatcher, context)\nexpect(netSocket.listenerCount(&#x27;data&#x27;)).to.be.equal(1)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;102d3e09-05e6-4526-ac29-a7cfa0df97f0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;log socket events&quot;,&quot;fullTitle&quot;:&quot;ConnectionObserver log socket events&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug               = require(&#x27;@superhero/debug&#x27;),\nlog                 = new Debug({ debug:false }),\nFactory             = require(&#x27;../../&#x27;),\nfactory             = new Factory,\nconnectionObserver  = factory.createConnectionObserverFactory(log).create(),\nnetSocket           = factory.createNetSocket(),\nemitter             = connectionObserver.emitter\nfor(const event of [&#x27;close&#x27;,&#x27;connection&#x27;,&#x27;drain&#x27;,&#x27;lookup&#x27;,&#x27;timeout&#x27;,&#x27;error&#x27;])\n  expect(event + netSocket.listenerCount(event)).to.be.equal(event + 0)\nconnectionObserver.logSocketEvents(netSocket, log)\nfor(const event of [&#x27;close&#x27;,&#x27;connection&#x27;,&#x27;drain&#x27;,&#x27;lookup&#x27;,&#x27;timeout&#x27;,&#x27;error&#x27;])\n  expect(event + netSocket.listenerCount(event)).to.be.equal(event + 1)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e7d40d4c-6ff1-402f-8028-d435df84a7d2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;the \&quot;onConnection\&quot; function attaches the expected listeners&quot;,&quot;fullTitle&quot;:&quot;ConnectionObserver the \&quot;onConnection\&quot; function attaches the expected listeners&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug               = require(&#x27;@superhero/debug&#x27;),\nlog                 = new Debug({ debug:false }),\nFactory             = require(&#x27;../../&#x27;),\nfactory             = new Factory,\nconnectionObserver  = factory.createConnectionObserverFactory(log).create(),\nnetSocket           = factory.createNetSocket()\nfor(const event of [&#x27;close&#x27;,&#x27;connection&#x27;,&#x27;drain&#x27;,&#x27;lookup&#x27;,&#x27;timeout&#x27;,&#x27;error&#x27;,&#x27;data&#x27;])\n  expect(event + netSocket.listenerCount(event)).to.be.equal(event + 0)\nconnectionObserver.onConnection(netSocket)\nfor(const event of [&#x27;close&#x27;,&#x27;connection&#x27;,&#x27;drain&#x27;,&#x27;lookup&#x27;,&#x27;timeout&#x27;,&#x27;error&#x27;,&#x27;data&#x27;])\n  expect(event + netSocket.listenerCount(event)).to.be.equal(event + 1)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b19b0f31-d8ee-4a4e-82e6-d5fd3860edbb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;102d3e09-05e6-4526-ac29-a7cfa0df97f0&quot;,&quot;e7d40d4c-6ff1-402f-8028-d435df84a7d2&quot;,&quot;b19b0f31-d8ee-4a4e-82e6-d5fd3860edbb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;df3fdbda-3cc0-46a7-8fb5-6653ce1f0b5e&quot;,&quot;title&quot;:&quot;Context&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/context/context.test.js&quot;,&quot;file&quot;:&quot;/src/context/context.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;expected format&quot;,&quot;fullTitle&quot;:&quot;Context expected format&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug         = require(&#x27;@superhero/debug&#x27;),\nlog           = new Debug({ debug:false }),\nFactory       = require(&#x27;../../&#x27;),\nfactory       = new Factory,\nemitter       = factory.createEmitterFactory(log).create(),\nnetSocket     = factory.createNetSocket(),\ncontext       = factory.createContextFactory(log).create(netSocket, emitter),\nPayloadStack  = require(&#x27;../payload-stack&#x27;)\nexpect(context.socket).deep.equal(netSocket)\nexpect(context.emit).to.be.a(&#x27;function&#x27;)\nexpect(context.payloadStack).to.be.an.instanceof(PayloadStack)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b25e6139-c0d7-4112-8f03-9c7bbf366294&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b25e6139-c0d7-4112-8f03-9c7bbf366294&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;54ccc3f8-2257-4ad1-9fd6-b83b4a77ff90&quot;,&quot;title&quot;:&quot;Dispatcher&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/dispatcher/dispatcher.test.js&quot;,&quot;file&quot;:&quot;/src/dispatcher/dispatcher.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;handle error&quot;,&quot;fullTitle&quot;:&quot;Dispatcher handle error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug                   = require(&#x27;@superhero/debug&#x27;),\nlog                     = new Debug({ debug:false }),\nFactory                 = require(&#x27;../../&#x27;),\nfactory                 = new Factory,\ndispatcher              = factory.createDispatcherFactory(log).create(),\nIncompleteMessageError  = require(&#x27;../payload-stack/error/incomplete-message&#x27;),\nincompleteMessageError  = new IncompleteMessageError,\nerror                   = new Error,\ncallbackThrows          = dispatcher.handleError.bind(dispatcher, error),\ncallbackDoesNotThrow    = dispatcher.handleError.bind(dispatcher, incompleteMessageError)\nexpect(callbackThrows).to.throw()\nexpect(callbackDoesNotThrow).to.not.throw()&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;092a6f72-299d-4019-bb73-67d11715c965&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;loop through context buffer to dispatch each message one by one&quot;,&quot;fullTitle&quot;:&quot;Dispatcher loop through context buffer to dispatch each message one by one&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug           = require(&#x27;@superhero/debug&#x27;),\nlog             = new Debug({ debug:false }),\nFactory         = require(&#x27;../../&#x27;),\nfactory         = new Factory,\ndispatcher      = factory.createDispatcherFactory(log).create(),\npayloadFactory  = factory.createPayloadFactory(),\nevent           = &#x27;foobar&#x27;,\nbody            = { foo:&#x27;bar&#x27; },\nbuffer          = payloadFactory.create(event, body).toBuffer(),\nemitter         = factory.createEmitterFactory(log).create(),\nport            = 18200,\nnetClient       = require(&#x27;net&#x27;).createConnection({ port }),\nnetServer       = require(&#x27;net&#x27;).createServer().listen(port),\ncontext         = factory.createContextFactory().create(netClient, emitter)\ncontext.payloadStack.push(buffer, buffer)\nnetClient.on(&#x27;connect&#x27;, () =&gt; dispatcher.loopThroughContextBufferToDispatchEachMessageOneByOne(context))\nlet i = 0\ndispatcher.events.on(event, (context, data) =&gt;\n{\n  if(++i === 2)\n  {\n    expect(data).to.deep.equal(body)\n    netClient.end()\n    netServer.close()\n    done()\n  }\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;bfc98168-30c9-4ef5-8726-150ece98d5cc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;092a6f72-299d-4019-bb73-67d11715c965&quot;,&quot;bfc98168-30c9-4ef5-8726-150ece98d5cc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a1a2d997-33dc-4284-90c4-a422dd2a8cf8&quot;,&quot;title&quot;:&quot;Emitter&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/emitter/emitter.test.js&quot;,&quot;file&quot;:&quot;/src/emitter/emitter.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;write buffer to socket&quot;,&quot;fullTitle&quot;:&quot;Emitter write buffer to socket&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug     = require(&#x27;@superhero/debug&#x27;),\nlog       = new Debug({ debug:false }),\nFactory   = require(&#x27;../../&#x27;),\nfactory   = new Factory,\nemitter   = factory.createEmitterFactory(log).create(),\nport      = 18200,\nnetClient = require(&#x27;net&#x27;).createConnection({ port }),\nnetServer = require(&#x27;net&#x27;).createServer().listen(port),\nbuffer    = Buffer.from(&#x27;foobar&#x27;)\nnetClient.on(&#x27;connect&#x27;, async () =&gt;\n{\n  await emitter.writeBufferToSocket(netClient, buffer)\n})\nnetServer.on(&#x27;connection&#x27;, (socket) =&gt;\n{\n  socket.on(&#x27;data&#x27;, (data) =&gt;\n  {\n    expect(data.toString()).to.be.equal(buffer.toString())\n    socket.end()\n    netServer.close()\n  })\n})\nnetServer.on(&#x27;close&#x27;, () =&gt; done())&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;29f2b16d-88e6-4cf3-a3dc-c7f59f8fa90f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;emit event with data&quot;,&quot;fullTitle&quot;:&quot;Emitter emit event with data&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nFactory       = require(&#x27;../../&#x27;),\nfactory       = new Factory,\npayloadStack  = factory.createPayloadStackFactory().create(),\nDebug         = require(&#x27;@superhero/debug&#x27;),\nlog           = new Debug({ debug:false }),\nemitter       = factory.createEmitterFactory(log).create(),\nport          = 18200,\nnetClient     = require(&#x27;net&#x27;).createConnection({ port }),\nnetServer     = require(&#x27;net&#x27;).createServer().listen(port),\nevent         = &#x27;foobar&#x27;,\nbody          = { foo:&#x27;bar&#x27; }\nnetClient.on(&#x27;connect&#x27;, async () =&gt;\n{\n  await emitter.emit(netClient, event, body)\n})\nnetServer.on(&#x27;connection&#x27;, (socket) =&gt;\n{\n  socket.on(&#x27;data&#x27;, (data) =&gt;\n  {\n    payloadStack.push(data)\n    const dto = payloadStack.shift()\n    expect(dto.event).to.be.equal(event)\n    expect(dto.data).to.deep.equal(body)\n    socket.end()\n    netServer.close()\n  })\n})\nnetServer.on(&#x27;close&#x27;, () =&gt; done())&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;1c09849a-4d27-4abb-a51a-da24936d7d22&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;29f2b16d-88e6-4cf3-a3dc-c7f59f8fa90f&quot;,&quot;1c09849a-4d27-4abb-a51a-da24936d7d22&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;c532bafc-1737-4251-8d66-6bce622e162c&quot;,&quot;title&quot;:&quot;Payload/Error/IncompleteMessage&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/payload-stack/error/incomplete-message.test.js&quot;,&quot;file&quot;:&quot;/src/payload-stack/error/incomplete-message.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;is of expected type&quot;,&quot;fullTitle&quot;:&quot;Payload/Error/IncompleteMessage is of expected type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nIncompleteMessageError = require(&#x27;./incomplete-message&#x27;),\nerror = new IncompleteMessageError\nexpect(error).to.be.an.instanceof(Error)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;4b848531-695b-46bb-bf8e-96001e5d0560&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;has expected error code&quot;,&quot;fullTitle&quot;:&quot;Payload/Error/IncompleteMessage has expected error code&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nIncompleteMessageError = require(&#x27;./incomplete-message&#x27;),\nerror = new IncompleteMessageError\nexpect(error.code).to.be.equal(&#x27;ERR_INCOMPLETE_MESSAGE&#x27;)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9843b24a-48ac-4f89-9859-49cdb93e56d4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;4b848531-695b-46bb-bf8e-96001e5d0560&quot;,&quot;9843b24a-48ac-4f89-9859-49cdb93e56d4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;306222c3-3824-46b2-933d-0b24080253df&quot;,&quot;title&quot;:&quot;PayloadStack&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/payload-stack/payload-stack.test.js&quot;,&quot;file&quot;:&quot;/src/payload-stack/payload-stack.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;push and shift message from buffer stack&quot;,&quot;fullTitle&quot;:&quot;PayloadStack push and shift message from buffer stack&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nFactory       = require(&#x27;../../&#x27;),\nfactory       = new Factory,\npayloadStack  = factory.createPayloadStackFactory().create(),\nfoo           = &#x27;foobar&#x27;,\ndata          = { foo:&#x27;bar&#x27; },\npayload       = factory.createPayloadFactory().create(foo, data),\nbuffer        = payload.toBuffer()\npayloadStack.push(buffer)\nconst message = payloadStack.shift()\nexpect(message.event).to.be.equal(foo)\nexpect(message.data).deep.equal(data)\nexpect(payloadStack.stack.length).to.be.equal(0)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;13ca0267-d5ba-44e1-ac58-8828a0e1c284&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;shift a message from the buffer stack that holds a broken message&quot;,&quot;fullTitle&quot;:&quot;PayloadStack shift a message from the buffer stack that holds a broken message&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nFactory       = require(&#x27;../../&#x27;),\nfactory       = new Factory,\npayloadStack  = factory.createPayloadStackFactory().create(),\nevent         = &#x27;foobar&#x27;,\ndata          = { foo:&#x27;bar&#x27; },\npayload       = factory.createPayloadFactory().create(event, data),\nbuffer        = payload.toBuffer().slice(20),\ncallback      = payloadStack.shift.bind(payloadStack)\npayloadStack.push(buffer)\nexpect(callback).to.throw(Error).with.property(&#x27;code&#x27;, &#x27;ERR_INCOMPLETE_MESSAGE&#x27;)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;63aba77b-0475-4451-8e24-81fe6d5a72b4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;13ca0267-d5ba-44e1-ac58-8828a0e1c284&quot;,&quot;63aba77b-0475-4451-8e24-81fe6d5a72b4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;8b7db464-e8ca-4398-8f53-6ba3bb3ad583&quot;,&quot;title&quot;:&quot;Payload&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/payload/payload.test.js&quot;,&quot;file&quot;:&quot;/src/payload/payload.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;is mutable&quot;,&quot;fullTitle&quot;:&quot;Payload is mutable&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nevent   = &#x27;foobar&#x27;,\ndata    = { foo:&#x27;bar&#x27; },\nFactory = require(&#x27;../../&#x27;),\nfactory = new Factory,\npayload = factory.createPayloadFactory().create(event, data)\npayload.event = &#x27;barbaz&#x27;\nexpect(payload.event).to.be.equal(event)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;be86e7fc-ee76-488b-9a54-51f757dcda03&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;can be represented as a buffer&quot;,&quot;fullTitle&quot;:&quot;Payload can be represented as a buffer&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nevent   = &#x27;foobar&#x27;,\ndata    = { foo:&#x27;bar&#x27; },\nFactory = require(&#x27;../../&#x27;),\nfactory = new Factory,\npayload = factory.createPayloadFactory().create(event, data)\npayload.event = &#x27;barbaz&#x27;\nexpect(payload.toBuffer.bind(payload)).to.not.throw()&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;03e4c061-4ed5-4ba8-a901-211bbc594ccd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;buffer has a header that describes the correct length of the buffer&quot;,&quot;fullTitle&quot;:&quot;Payload buffer has a header that describes the correct length of the buffer&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nevent   = &#x27;foobar&#x27;,\ndata    = { foo:&#x27;bar&#x27; },\nFactory = require(&#x27;../../&#x27;),\nfactory = new Factory,\npayload = factory.createPayloadFactory().create(event, data),\nbuffer  = payload.toBuffer(),\nlength  = buffer.readInt32BE(0),\nPayload = require(&#x27;.&#x27;)\nexpect(Payload.HEADER_SIZE + length).to.be.equal(buffer.length)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e635c330-a29b-4fcf-89e6-6b875c820d2b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;be86e7fc-ee76-488b-9a54-51f757dcda03&quot;,&quot;03e4c061-4ed5-4ba8-a901-211bbc594ccd&quot;,&quot;e635c330-a29b-4fcf-89e6-6b875c820d2b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;4cbe7fa1-ce95-497a-988b-f7fa16f42467&quot;,&quot;title&quot;:&quot;Server&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/server/server.test.js&quot;,&quot;file&quot;:&quot;/src/server/server.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;integration test between server and client&quot;,&quot;fullTitle&quot;:&quot;Server integration test between server and client&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nFactory = require(&#x27;../../&#x27;),\nfactory = new Factory,\nDebug   = require(&#x27;@superhero/debug&#x27;),\nlog     = new Debug({ debug:false }),\nclient  = factory.createClient(log),\nserver  = factory.createServer(log),\nport    = 18200,\nevent   = &#x27;foobar&#x27;,\nbody    = { foo:&#x27;bar&#x27; }\nserver.listen(port)\nclient.connect(port)\nclient.emit(event, body)\nserver.on(event, (context, data) =&gt;\n{\n  expect(data).to.deep.equal(body)\n  context.emit(event, body)\n})\nclient.on(event, (context, data) =&gt;\n{\n  expect(data).to.deep.equal(body)\n  client.client.end()\n  server.server.close()\n  done()\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;46ce24e5-bf36-43df-8fb9-3069b8469f05&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;possible to remove a listener&quot;,&quot;fullTitle&quot;:&quot;Server possible to remove a listener&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nFactory   = require(&#x27;../../&#x27;),\nfactory   = new Factory,\nDebug     = require(&#x27;@superhero/debug&#x27;),\nlog       = new Debug({ debug:false }),\nserver    = factory.createServer(log),\nevent     = &#x27;foobar&#x27;,\nlistener  = () =&gt; {}\nexpect(server.connectionObserver.dispatcher.events.listenerCount(event)).to.deep.equal(0)\nserver.on(event, listener)\nexpect(server.connectionObserver.dispatcher.events.listenerCount(event)).to.deep.equal(1)\nserver.removeListener(event, listener)\nexpect(server.connectionObserver.dispatcher.events.listenerCount(event)).to.deep.equal(0)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;9e644233-4ff0-4ecc-b06f-bf5c67c2e017&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;46ce24e5-bf36-43df-8fb9-3069b8469f05&quot;,&quot;9e644233-4ff0-4ecc-b06f-bf5c67c2e017&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:2000},&quot;copyrightYear&quot;:2018}" data-config="{&quot;reportFilename&quot;:&quot;index&quot;,&quot;reportDir&quot;:&quot;doc/tests&quot;,&quot;reportTitle&quot;:&quot;js.socket&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:true,&quot;enableCharts&quot;:true,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;always&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;doc/tests/assets&quot;,&quot;jsonFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/doc/tests/index.json&quot;,&quot;htmlFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/doc/tests/index.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>