<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:9,&quot;tests&quot;:19,&quot;passes&quot;:19,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2018-10-26T14:50:38.358Z&quot;,&quot;end&quot;:&quot;2018-10-26T14:50:38.383Z&quot;,&quot;duration&quot;:25,&quot;testsRegistered&quot;:19,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false,&quot;passPercentClass&quot;:&quot;success&quot;,&quot;pendingPercentClass&quot;:&quot;danger&quot;},&quot;suites&quot;:{&quot;uuid&quot;:&quot;a8297b82-344a-483d-ac05-9b67c208d9e3&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;d236af0f-8c92-4217-9273-1d48d38c87d1&quot;,&quot;title&quot;:&quot;Socket/Client&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/client.test.js&quot;,&quot;file&quot;:&quot;/src/client.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;integration test between client and server&quot;,&quot;fullTitle&quot;:&quot;Socket/Client integration test between client and server&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug         = require(&#x27;@superhero/debug&#x27;),\nlog           = new Debug({ debug:false }),\nSocketServer  = require(&#x27;./server&#x27;),\nsocketServer  = new SocketServer(log),\nSocketClient  = require(&#x27;./client&#x27;),\nsocketClient  = new SocketClient(log),\nport          = 18200,\nevent         = &#x27;foobar&#x27;,\nbody          = { foo:&#x27;bar&#x27; }\nsocketServer.listen(port)\nsocketClient.connect(port)\nsocketClient.emit(event, body)\nsocketServer.on(event, (context, data) =&gt;\n{\n  expect(data).to.deep.equal(body)\n  socketClient.client.end()\n  socketServer.server.close()\n  done()\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;047dc6a2-8f8c-4971-a2c3-4d17c3523e7c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;possible to remove a listener&quot;,&quot;fullTitle&quot;:&quot;Socket/Client possible to remove a listener&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug         = require(&#x27;@superhero/debug&#x27;),\nlog           = new Debug({ debug:false }),\nSocketClient  = require(&#x27;./client&#x27;),\nsocketClient  = new SocketClient(log),\nevent         = &#x27;foobar&#x27;,\nlistener      = () =&gt; {}\nexpect(socketClient.connection.dispatcher.events.listenerCount(event)).to.deep.equal(0)\nsocketClient.on(event, listener)\nexpect(socketClient.connection.dispatcher.events.listenerCount(event)).to.deep.equal(1)\nsocketClient.removeListener(event, listener)\nexpect(socketClient.connection.dispatcher.events.listenerCount(event)).to.deep.equal(0)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;e3b9d263-8cf9-4ff7-ae0d-1fe1cfcb4ad7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;047dc6a2-8f8c-4971-a2c3-4d17c3523e7c&quot;,&quot;e3b9d263-8cf9-4ff7-ae0d-1fe1cfcb4ad7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;1437999c-fbaa-485d-ada2-d472292d15f0&quot;,&quot;title&quot;:&quot;Socket/Connection&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/connection.test.js&quot;,&quot;file&quot;:&quot;/src/connection.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;attach data event to dispatcher with a context&quot;,&quot;fullTitle&quot;:&quot;Socket/Connection attach data event to dispatcher with a context&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug             = require(&#x27;@superhero/debug&#x27;),\nlog               = new Debug({ debug:false }),\nEvents            = require(&#x27;events&#x27;),\nevents            = new Events,\nSocketConnection  = require(&#x27;./connection&#x27;),\nsocketConnection  = new SocketConnection(log, events),\nNetSocket         = require(&#x27;net&#x27;).Socket,\nnetSocket         = new NetSocket,\ndispatcher        = socketConnection.dispatcher,\nemitter           = socketConnection.emitter,\nSocketContext     = require(&#x27;./context&#x27;),\nsocketContext     = new SocketContext(netSocket, emitter)\nexpect(netSocket.listenerCount(&#x27;data&#x27;)).to.be.equal(0)\nsocketConnection.attachDataEventToDispatcherWithAContext(netSocket, dispatcher, context)\nexpect(netSocket.listenerCount(&#x27;data&#x27;)).to.be.equal(1)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;28985981-4c7d-4240-8a76-45e95c0b730c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;log socket events&quot;,&quot;fullTitle&quot;:&quot;Socket/Connection log socket events&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug             = require(&#x27;@superhero/debug&#x27;),\nlog               = new Debug({ debug:false }),\nEvents            = require(&#x27;events&#x27;),\nevents            = new Events,\nSocketConnection  = require(&#x27;./connection&#x27;),\nsocketConnection  = new SocketConnection(log, events),\nNetSocket         = require(&#x27;net&#x27;).Socket,\nnetSocket         = new NetSocket,\nemitter           = socketConnection.emitter\nfor(const event of [&#x27;close&#x27;,&#x27;connection&#x27;,&#x27;drain&#x27;,&#x27;lookup&#x27;,&#x27;timeout&#x27;,&#x27;error&#x27;])\n  expect(event + netSocket.listenerCount(event)).to.be.equal(event + 0)\nsocketConnection.logSocketEvents(netSocket, log)\nfor(const event of [&#x27;close&#x27;,&#x27;connection&#x27;,&#x27;drain&#x27;,&#x27;lookup&#x27;,&#x27;timeout&#x27;,&#x27;error&#x27;])\n  expect(event + netSocket.listenerCount(event)).to.be.equal(event + 1)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;1b208a78-edbe-4a76-aacc-16d0455e3025&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;the \&quot;onConnection\&quot; function attaches the expected listeners&quot;,&quot;fullTitle&quot;:&quot;Socket/Connection the \&quot;onConnection\&quot; function attaches the expected listeners&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug             = require(&#x27;@superhero/debug&#x27;),\nlog               = new Debug({ debug:false }),\nEvents            = require(&#x27;events&#x27;),\nevents            = new Events,\nSocketConnection  = require(&#x27;./connection&#x27;),\nsocketConnection  = new SocketConnection(log, events),\nNetSocket         = require(&#x27;net&#x27;).Socket,\nnetSocket         = new NetSocket\nfor(const event of [&#x27;close&#x27;,&#x27;connection&#x27;,&#x27;drain&#x27;,&#x27;lookup&#x27;,&#x27;timeout&#x27;,&#x27;error&#x27;,&#x27;data&#x27;])\n  expect(event + netSocket.listenerCount(event)).to.be.equal(event + 0)\nsocketConnection.onConnection(netSocket)\nfor(const event of [&#x27;close&#x27;,&#x27;connection&#x27;,&#x27;drain&#x27;,&#x27;lookup&#x27;,&#x27;timeout&#x27;,&#x27;error&#x27;,&#x27;data&#x27;])\n  expect(event + netSocket.listenerCount(event)).to.be.equal(event + 1)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;0e1a68d5-5a92-42bd-8a1d-57482a64c963&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;28985981-4c7d-4240-8a76-45e95c0b730c&quot;,&quot;1b208a78-edbe-4a76-aacc-16d0455e3025&quot;,&quot;0e1a68d5-5a92-42bd-8a1d-57482a64c963&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;258b7927-1ad0-44ba-ac97-da673a18a57d&quot;,&quot;title&quot;:&quot;Socket/Context&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/context.test.js&quot;,&quot;file&quot;:&quot;/src/context.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;expected format&quot;,&quot;fullTitle&quot;:&quot;Socket/Context expected format&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug         = require(&#x27;@superhero/debug&#x27;),\nlog           = new Debug({ debug:false }),\nEmitter       = require(&#x27;./emitter&#x27;),\nemitter       = new Emitter(log),\nNetSocket     = require(&#x27;net&#x27;).Socket,\nnetSocket     = new NetSocket,\nSocketContext = require(&#x27;./context&#x27;),\nsocketContext = new SocketContext(netSocket, emitter),\nPayloadStack  = require(&#x27;./payload-stack&#x27;)\nexpect(socketContext.socket).deep.equal(netSocket)\nexpect(socketContext.emit).to.be.a(&#x27;function&#x27;)\nexpect(socketContext.payloadStack).to.be.an.instanceof(PayloadStack)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b230988a-63b9-4c8f-b898-b147d50fd01d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b230988a-63b9-4c8f-b898-b147d50fd01d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;32c7e65d-a0ce-4d91-91ee-4e0c44255b48&quot;,&quot;title&quot;:&quot;Socket/Dispatcher&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/dispatcher.test.js&quot;,&quot;file&quot;:&quot;/src/dispatcher.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;handle error&quot;,&quot;fullTitle&quot;:&quot;Socket/Dispatcher handle error&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug                   = require(&#x27;@superhero/debug&#x27;),\nlog                     = new Debug({ debug:false }),\nDispatcher              = require(&#x27;./dispatcher&#x27;),\ndispatcher              = new Dispatcher(log),\nIncompleteMessageError  = require(&#x27;./payload-stack/error/incomplete-message&#x27;),\nincompleteMessageError  = new IncompleteMessageError,\nerror                   = new Error,\ncallbackThrows          = dispatcher.handleError.bind(dispatcher, error),\ncallbackDoesNotThrow    = dispatcher.handleError.bind(dispatcher, incompleteMessageError)\nexpect(callbackThrows).to.throw()\nexpect(callbackDoesNotThrow).to.not.throw()&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;01dc64f9-3c98-4e13-98f3-ac2ea4685f45&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;loop through context buffer to dispatch each message one by one&quot;,&quot;fullTitle&quot;:&quot;Socket/Dispatcher loop through context buffer to dispatch each message one by one&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug             = require(&#x27;@superhero/debug&#x27;),\nlog               = new Debug({ debug:false }),\nSocketDispatcher  = require(&#x27;./dispatcher&#x27;),\nsocketDispatcher  = new SocketDispatcher(log),\nSocketPayload     = require(&#x27;./payload-stack/payload&#x27;),\nevent             = &#x27;foobar&#x27;,\nbody              = { foo:&#x27;bar&#x27; },\nbuffer            = new SocketPayload(event, body).toBuffer(),\nSocketEmitter     = require(&#x27;./emitter&#x27;),\nsocketEmitter     = new SocketEmitter(log),\nport              = 18200,\nnetClient         = require(&#x27;net&#x27;).createConnection({ port }),\nnetServer         = require(&#x27;net&#x27;).createServer().listen(port),\nSocketContext     = require(&#x27;./context&#x27;),\nsocketContext     = new SocketContext(netClient, socketEmitter)\nsocketContext.payloadStack.push(buffer, buffer)\nnetClient.on(&#x27;connect&#x27;, () =&gt; socketDispatcher.loopThroughContextBufferToDispatchEachMessageOneByOne(socketContext))\nlet i = 0\nsocketDispatcher.events.on(event, (context, data) =&gt;\n{\n  if(++i === 2)\n  {\n    expect(data).to.deep.equal(body)\n    netClient.end()\n    netServer.close()\n    done()\n  }\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;f0abf415-9584-4a0a-9c33-59c0a09e4ab2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;01dc64f9-3c98-4e13-98f3-ac2ea4685f45&quot;,&quot;f0abf415-9584-4a0a-9c33-59c0a09e4ab2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;fe07c003-d31f-4b29-9523-456232d123bc&quot;,&quot;title&quot;:&quot;Socket/Emitter&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/emitter.test.js&quot;,&quot;file&quot;:&quot;/src/emitter.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;write buffer to socket&quot;,&quot;fullTitle&quot;:&quot;Socket/Emitter write buffer to socket&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug         = require(&#x27;@superhero/debug&#x27;),\nlog           = new Debug({ debug:false }),\nSocketEmitter = require(&#x27;./emitter&#x27;),\nsocketEmitter = new SocketEmitter(log),\nport          = 18200,\nnetClient     = require(&#x27;net&#x27;).createConnection({ port }),\nnetServer     = require(&#x27;net&#x27;).createServer().listen(port),\nbuffer        = Buffer.from(&#x27;foobar&#x27;)\nnetClient.on(&#x27;connect&#x27;, async () =&gt;\n{\n  await socketEmitter.writeBufferToSocket(netClient, buffer)\n})\nnetServer.on(&#x27;connection&#x27;, (socket) =&gt; socket.on(&#x27;data&#x27;, (data) =&gt;\n{\n  expect(data.toString()).to.be.equal(buffer.toString())\n  socket.end()\n  netServer.close()\n}))\nnetServer.on(&#x27;close&#x27;, () =&gt; done())&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;fd86e080-56b9-4ee4-bc49-d486c84f72e9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;emit event with data&quot;,&quot;fullTitle&quot;:&quot;Socket/Emitter emit event with data&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nSocketPayloadStack  = require(&#x27;./payload-stack&#x27;),\nsocketPayloadStack  = new SocketPayloadStack,\nDebug               = require(&#x27;@superhero/debug&#x27;),\nlog                 = new Debug({ debug:false }),\nSocketEmitter       = require(&#x27;./emitter&#x27;),\nsocketEmitter       = new SocketEmitter(log),\nport                = 18200,\nnetClient           = require(&#x27;net&#x27;).createConnection({ port }),\nnetServer           = require(&#x27;net&#x27;).createServer().listen(port),\nevent               = &#x27;foobar&#x27;,\nbody                = { foo:&#x27;bar&#x27; }\nnetClient.on(&#x27;connect&#x27;, async () =&gt;\n{\n  await socketEmitter.emit(netClient, event, body)\n})\nnetServer.on(&#x27;connection&#x27;, (socket) =&gt;\n{\n  socket.on(&#x27;data&#x27;, (data) =&gt;\n  {\n    socketPayloadStack.push(data)\n    const dto = socketPayloadStack.shift()\n    expect(dto.event).to.be.equal(event)\n    expect(dto.data).to.deep.equal(body)\n    socket.end()\n    netServer.close()\n  })\n})\nnetServer.on(&#x27;close&#x27;, () =&gt; done())&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;7d0649d5-3c70-4ad2-8435-4a03725c5aee&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;fd86e080-56b9-4ee4-bc49-d486c84f72e9&quot;,&quot;7d0649d5-3c70-4ad2-8435-4a03725c5aee&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;45ce3337-0547-4ac0-bbf2-c74b1477c2df&quot;,&quot;title&quot;:&quot;Socket/Payload/Error/IncompleteMessage&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/payload-stack/error/incomplete-message.test.js&quot;,&quot;file&quot;:&quot;/src/payload-stack/error/incomplete-message.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;is of expected type&quot;,&quot;fullTitle&quot;:&quot;Socket/Payload/Error/IncompleteMessage is of expected type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nIncompleteMessageError = require(&#x27;./incomplete-message&#x27;),\nerror = new IncompleteMessageError\nexpect(error).to.be.an.instanceof(Error)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;971da53e-f47c-442e-846f-b476aeef7ce5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;has expected error code&quot;,&quot;fullTitle&quot;:&quot;Socket/Payload/Error/IncompleteMessage has expected error code&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nIncompleteMessageError = require(&#x27;./incomplete-message&#x27;),\nerror = new IncompleteMessageError\nexpect(error.code).to.be.equal(&#x27;ERR_INCOMPLETE_MESSAGE&#x27;)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;65a1863f-cc3a-4775-b092-b621bd6f7da1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;971da53e-f47c-442e-846f-b476aeef7ce5&quot;,&quot;65a1863f-cc3a-4775-b092-b621bd6f7da1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b4b82a5d-4444-4c65-bcfa-afecff94b7b5&quot;,&quot;title&quot;:&quot;Socket/PayloadStack&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/payload-stack/index.test.js&quot;,&quot;file&quot;:&quot;/src/payload-stack/index.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;push and shift message from buffer stack&quot;,&quot;fullTitle&quot;:&quot;Socket/PayloadStack push and shift message from buffer stack&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nSocketPayloadStack  = require(&#x27;./index&#x27;),\nsocketPayloadStack  = new SocketPayloadStack,\nfoo                 = &#x27;foobar&#x27;,\ndata                = { foo:&#x27;bar&#x27; },\nSocketPayload       = require(&#x27;./payload&#x27;),\nsocketPayload       = new SocketPayload(foo, data),\nbuffer              = socketPayload.toBuffer()\nsocketPayloadStack.push(buffer)\nconst message = socketPayloadStack.shift()\nexpect(message.event).to.be.equal(foo)\nexpect(message.data).deep.equal(data)\nexpect(socketPayloadStack.stack.length).to.be.equal(0)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c469166e-77df-4444-ba10-e5d0efff4ab2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;shift a message from the buffer stack that holds a broken message&quot;,&quot;fullTitle&quot;:&quot;Socket/PayloadStack shift a message from the buffer stack that holds a broken message&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nSocketPayloadStack  = require(&#x27;./index&#x27;),\nsocketPayloadStack  = new SocketPayloadStack,\nevent               = &#x27;foobar&#x27;,\ndata                = { foo:&#x27;bar&#x27; },\nSocketPayload       = require(&#x27;./payload&#x27;),\nsocketPayload       = new SocketPayload(event, data),\nbuffer              = socketPayload.toBuffer().slice(20),\ncallback            = socketPayloadStack.shift.bind(socketPayloadStack)\nsocketPayloadStack.push(buffer)\nexpect(callback).to.throw(Error).with.property(&#x27;code&#x27;, &#x27;ERR_INCOMPLETE_MESSAGE&#x27;)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;bad51fbb-f465-46b0-b246-cb9ed4f8f230&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c469166e-77df-4444-ba10-e5d0efff4ab2&quot;,&quot;bad51fbb-f465-46b0-b246-cb9ed4f8f230&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b279ee4c-b204-4480-adf0-55f6ea8820e0&quot;,&quot;title&quot;:&quot;Socket/PayloadStack/Payload&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/payload-stack/payload/index.test.js&quot;,&quot;file&quot;:&quot;/src/payload-stack/payload/index.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;is mutable&quot;,&quot;fullTitle&quot;:&quot;Socket/PayloadStack/Payload is mutable&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nevent = &#x27;foobar&#x27;,\ndata  = { foo:&#x27;bar&#x27; },\nSocketPayload = require(&#x27;./index&#x27;),\nsocketPayload = new SocketPayload(event, data)\nsocketPayload.event = &#x27;barbaz&#x27;\nexpect(socketPayload.event).to.be.equal(event)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;b5a86896-285e-433d-94e6-494fb1638379&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;can be represented as a buffer&quot;,&quot;fullTitle&quot;:&quot;Socket/PayloadStack/Payload can be represented as a buffer&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nevent = &#x27;foobar&#x27;,\ndata  = { foo:&#x27;bar&#x27; },\nSocketPayload = require(&#x27;./index&#x27;),\nsocketPayload = new SocketPayload(event, data)\nsocketPayload.event = &#x27;barbaz&#x27;\nexpect(socketPayload.toBuffer.bind(socketPayload)).to.not.throw()&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;c716c5f0-e91a-4674-8467-7dad33186029&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;buffer has a header that describes the correct length of the buffer&quot;,&quot;fullTitle&quot;:&quot;Socket/PayloadStack/Payload buffer has a header that describes the correct length of the buffer&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nevent = &#x27;foobar&#x27;,\ndata  = { foo:&#x27;bar&#x27; },\nSocketPayload = require(&#x27;./index&#x27;),\nsocketPayload = new SocketPayload(event, data),\nbuffer = socketPayload.toBuffer(),\nlength = buffer.readInt32BE(0)\nexpect(SocketPayload.HEADER_SIZE + length).to.be.equal(buffer.length)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;46cd7205-65d6-4e31-885b-89bfbf280d51&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b5a86896-285e-433d-94e6-494fb1638379&quot;,&quot;c716c5f0-e91a-4674-8467-7dad33186029&quot;,&quot;46cd7205-65d6-4e31-885b-89bfbf280d51&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7a63ab90-fca6-4afe-9138-26399a2bbb32&quot;,&quot;title&quot;:&quot;Socket/Server&quot;,&quot;fullFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/src/server.test.js&quot;,&quot;file&quot;:&quot;/src/server.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;integration test between server and client&quot;,&quot;fullTitle&quot;:&quot;Socket/Server integration test between server and client&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug         = require(&#x27;@superhero/debug&#x27;),\nlog           = new Debug({ debug:false }),\nSocketServer  = require(&#x27;./server&#x27;),\nsocketServer  = new SocketServer(log),\nSocketClient  = require(&#x27;./client&#x27;),\nsocketClient  = new SocketClient(log),\nport          = 18200,\nevent         = &#x27;foobar&#x27;,\nbody          = { foo:&#x27;bar&#x27; }\nsocketServer.listen(port)\nsocketClient.connect(port)\nsocketClient.emit(event, body)\nsocketServer.on(event, (context, data) =&gt;\n{\n  expect(data).to.deep.equal(body)\n  context.emit(event, body)\n})\nsocketClient.on(event, (context, data) =&gt;\n{\n  expect(data).to.deep.equal(body)\n  socketClient.client.end()\n  socketServer.server.close()\n  done()\n})&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;2e550109-4c33-4b08-971e-0f85ccc64082&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;possible to remove a listener&quot;,&quot;fullTitle&quot;:&quot;Socket/Server possible to remove a listener&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const\nDebug         = require(&#x27;@superhero/debug&#x27;),\nlog           = new Debug({ debug:false }),\nSocketServer  = require(&#x27;./server&#x27;),\nsocketServer  = new SocketServer(log),\nevent         = &#x27;foobar&#x27;,\nlistener      = () =&gt; {}\nexpect(socketServer.connection.dispatcher.events.listenerCount(event)).to.deep.equal(0)\nsocketServer.on(event, listener)\nexpect(socketServer.connection.dispatcher.events.listenerCount(event)).to.deep.equal(1)\nsocketServer.removeListener(event, listener)\nexpect(socketServer.connection.dispatcher.events.listenerCount(event)).to.deep.equal(0)&quot;,&quot;err&quot;:{},&quot;isRoot&quot;:false,&quot;uuid&quot;:&quot;6ec6f4a0-5a65-4183-a916-e64e76b01e67&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2e550109-4c33-4b08-971e-0f85ccc64082&quot;,&quot;6ec6f4a0-5a65-4183-a916-e64e76b01e67&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:2000},&quot;copyrightYear&quot;:2018}" data-config="{&quot;reportFilename&quot;:&quot;index&quot;,&quot;reportDir&quot;:&quot;doc/tests&quot;,&quot;reportTitle&quot;:&quot;js.socket&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:true,&quot;enableCharts&quot;:true,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;always&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;doc/tests/assets&quot;,&quot;jsonFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/doc/tests/index.json&quot;,&quot;htmlFile&quot;:&quot;/home/erik/Projects/@superhero/js.socket/doc/tests/index.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>